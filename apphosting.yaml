# Settings to manage and configure a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

# --- BUILD CONFIGURATION ---
# This section tells App Hosting how to build your Next.js application.
# The 'steps' should typically include installing dependencies and running your build script.
build:
  steps:
    - run: npm install  # Installs your project dependencies
    - run: npm run build # Runs your Next.js build script (check your package.json)

# --- RUNTIME CONFIGURATION ---
# This section tells App Hosting how to run your application after it's built.
# 'maxInstances' is already there, but we can add more details.
runConfig:
  maxInstances: 1 # Starts with 1 instance, can be increased later for more traffic.
  # Other optional settings you might consider later (for performance/cost):
  # concurrency: 80     # Max requests per instance (default 80)
  # memoryMiB: 512      # Memory per instance in MiB (default 512)
  # cpu: 0              # CPUs per instance (default 0 for shared CPU, 1 for dedicated)

# --- ENVIRONMENT VARIABLES & SECRETS ---
# This section defines environment variables your app needs at runtime.
env:
  # This injects your Gemini API key from Secret Manager into your app's environment.
  # The 'secret' value MUST EXACTLY match the name you gave your secret in Secret Manager.
  GEMINI_API_KEY:
    secret: gemini-api-key-cardcraft # <-- DOUBLE-CHECK THIS NAME!
  # Standard environment variable for production builds.
  NODE_ENV:
    value: production
